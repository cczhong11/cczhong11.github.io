<!DOCTYPE html>
<html lang="en" class="wf-firasans-n4-active wf-active">
	<head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge"> <!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">   <meta name="generator" content="Hugo 0.47" /> 
<title>How to build your own apple script for omnifocus &middot; TC blog</title>
<meta content="How to build your own apple script for omnifocus - TC blog"
    property="og:title">
<meta content=" - This blog tells you some basic usage for apple script  for omnifocus"
    property="og:description"> <!-- CSS -->
<link href="https://fonts.googleapis.com/css?family=Fira+Sans:300,300i,400,400i|Roboto+Mono:300,300i,400,400i" rel="stylesheet">
<link rel="stylesheet" href="http://www.tczhong.com/css/print.css" media="print">
<link rel="stylesheet" href="http://www.tczhong.com/css/poole.css">
<link rel="stylesheet" href="http://www.tczhong.com/css/hyde.css"> <!-- Font-Awesome -->
<script defer src="https://use.fontawesome.com/releases/v5.0.10/js/all.js" integrity="sha384-slN8GvtUJGnv6ca26v8EzVaR9DC58QEwsIk9q1QXdCU8Yu8ck/tL/5szYlBbqmS+"
    crossorigin="anonymous"></script> <!-- highlight.js-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs.min.css"> <!-- Customised CSS -->
<link rel="stylesheet" href="http://www.tczhong.com/css/custom.css"> <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]--> <!-- Icons -->
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://www.tczhong.com/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="http://www.tczhong.com/favicon.png"> 

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-120924697-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-120924697-1');
</script>


	</head>
    <body>
        <div class="sidebar">
	<div class="container text-center sidebar-sticky">
		<div class="sidebar-about text-center">
			<a href="http://www.tczhong.com/"><h1 class="brand">TC blog</h1>
			 <img src="https://avatars2.githubusercontent.com/u/7358252?s=460&amp;v=4" alt="Author Image" class="img-circle headshot center"> </a>
			<p class="lead">
				 I am who I am. Love Cloud and Data science 
			</p>
		</div>
		
<div>
	<ul class="sidebar-nav">
		
		
				<li>
					<a href="http://www.tczhong.com/posts/"> <span>Posts</span></a>
				</li>
				<li>
					<a href="http://www.tczhong.com/about/hello"> <span>About</span></a>
				</li>
				<li>
					<a href="http://www.tczhong.com/tianchen_zhong.pdf"> <span>My Resume</span></a>
				</li>
				<li>
					<a href="http://www.tczhong.com/posts/project/index.html"> <span>Project</span></a>
				</li>
		</li>
	</ul>
</div>

        <p>
		<section class="row text-center">
	
	
	
	&nbsp;<a href="https://github.com/cczhong11"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	&nbsp;<a href="https://linkedin.com/in/tianchen-zhong"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	&nbsp;<a href="https://stackoverflow.com/users/7112540"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	&nbsp;<a href="mailto:tczhong24@gmail.com"><i class="fas fa-at fa-lg" aria-hidden="true"></i></a>
	
</section>

        </p>
		<p class="copyright">&copy; 2019 Tc Zhong.
        <a href="https://creativecommons.org/licenses/by/4.0">Some Rights Reserved</a>.<br/>Built with <a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
        </p>
	</div>
	<div>
	</div>
</div>

        <div class="content container">
            <div class="post">
  <h1>How to build your own apple script for omnifocus</h1>
  
  <div class="col-sm-12 col-md-12">
    <span class="text-left post-date meta">
            
       <i class="fa fa-calendar" aria-hidden="true"></i> Sep 9, 2018 
      
      
        
        
            in
            
            
                <a class="meta" href="http://www.tczhong.com/categories/gtd">GTD</a>
                ,
            
                <a class="meta" href="http://www.tczhong.com/categories/mac">MAC</a>
                ,
            
                <a class="meta" href="http://www.tczhong.com/categories/omnifocus">OMNIFOCUS</a>
                
            
        
      
      
      
      </span>  
  </div>    
  
  

<h1 id="how-to-use-apple-script-with-omnifocus">How to use apple script with Omnifocus</h1>

<p>Omnifocus is a very great to-do list app in Mac and iPhone. It is expensive and very good to use. We could also use apple script to make it become more powerful.</p>

<h2 id="list-all-done-tasks">List all done tasks</h2>

<p>In many cases, we need to do summary on how many tasks we have done that day or week. Therefore, we could just log out all completed tasks and send to notebook/Day one.</p>

<p>The general idea is to get all modified project and then get all tasks inside, if we saw any tasks with completion date during that day, we just log that tasks out.</p>

<p>The code could see here:</p>

<pre><code class="language-applescript">tell application &quot;OmniFocus&quot;
	tell front document
		-- Get the list of projects that were modified within thedate span
		set theProjects to every flattened project where its modification date is greater than startDate and modification date is less than endDate
		-- Loop through the matching project list
		repeat with a from 1 to length of theProjects
			-- Get the current project to work with
			set currentProj to item a of theProjects
			-- Get the tasks that were completed within the datespan
			set theTasks to (every flattened task of currentProj where its completed = true and completion date is greater than startDate and completion date is less than endDate)
			-- If there are tasks that meet the criteria
			if theTasks is not equal to {} then
				-- Add a dividing line and then enter the projectname
				set reportText to reportText &amp; return &amp; return &amp; &quot;# &quot; &amp; name of currentProj &amp; return
				-- Loop through the tasks
				repeat with b from 1 to length of theTasks
					-- Get the current task to work with
					set currentTask to item b of theTasks
					-- Save the completed date to a variable
					set completedDate to completion date of currentTask
					-- Get the time of the completed date
					set completedTime to time string of completedDate
					-- Add the task to the report text with thecompleted time
					set reportText to reportText &amp; return &amp; &quot; - &quot; &amp; name of currentTask &amp; &quot; ----- &quot; &amp; completedTime
				end repeat
			end if
		end repeat
    end tell -- end tell front document
end tell -- end tell application &quot;OmniFocus&quot;
</code></pre>

<h2 id="add-new-template-tasks">Add new template tasks</h2>

<p>We could use <code>dialog</code> to input some common things, for example, if we want to read book, using following code could get all important elements.</p>

<pre><code class="language-script">set bookTitle to text returned of (display dialog &quot;What's the title of the book?&quot; default answer &quot;&quot;)
set numPages to text returned of (display dialog &quot;How many pages are in the book?&quot; default answer 0) as integer
set startDate to text returned of (display dialog &quot;When should this start?&quot; default answer &quot;yyyymmdd&quot;)
set endDate to text returned of (display dialog &quot;When should this end?&quot; default answer &quot;yyyymmdd&quot;)
</code></pre>

<p>Then we could perform some calculation and add tasks to omnifocus.</p>

<pre><code class="language-script">tell application &quot;OmniFocus&quot;
	tell document of front window
        .....
        set newTask to make new inbox task with properties {name:taskTitle, defer date:deferDate, context:theContext}
    end tell
end tell
</code></pre>

<h2 id="tips">Tips</h2>

<ol>
<li><p>if you want to learn more, there are some repo</p>

<ul>
<li><a href="https://github.com/joebuhlig/OFScripts">OFscripts</a></li>
<li><a href="https://github.com/dbyler/omnifocus-scripts">omnifocus-scripts</a></li>
</ul></li>

<li><p>Open Apple script app, then choose open dictionary and open Omnifocus, you could see more commands.</p></li>
</ol>

</div>
            <div class="footer">
                <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

<script type="text/javascript">
    hljs.initHighlightingOnLoad();
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>


        <h2>Comments</h2>
        <div id="disqus_thread"></div>
<script type="text/javascript">
      (function () {
            
            
            
            if (location.hostname === "localhost" || 
            	location.hostname === "127.0.0.1" || 
            	location.hostname === "") {
                return;
			}
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            var disqus_shortname = 'tczhong';
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(
                  dsq);
      })();
</script>

<noscript>
	Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    

            </div>
        </div>
        
                
    </body>
</html>
